{"version":3,"file":"bundle.umd.js","sources":["src/HttpLink.js","src/HttpLinkModule.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { ApolloLink, Observable as LinkObservable, } from 'apollo-link';\nimport { print } from 'graphql/language/printer';\nimport { fetch, mergeHeaders, prioritize, } from 'apollo-angular-link-http-common';\n// XXX find a better name for it\nvar HttpLinkHandler = /** @class */ (function (_super) {\n    __extends(HttpLinkHandler, _super);\n    function HttpLinkHandler(httpClient, options) {\n        var _this = _super.call(this) || this;\n        _this.httpClient = httpClient;\n        _this.options = options;\n        _this.requester = function (operation) {\n            return new LinkObservable(function (observer) {\n                var context = operation.getContext();\n                // decides which value to pick, Context, Options or to just use the default\n                var pick = function (key, init) {\n                    return prioritize(context[key], _this.options[key], init);\n                };\n                var includeQuery = pick('includeQuery', true);\n                var includeExtensions = pick('includeExtensions', false);\n                var method = pick('method', 'POST');\n                var url = pick('uri', 'graphql');\n                var withCredentials = pick('withCredentials');\n                var req = {\n                    method: method,\n                    url: url,\n                    body: {\n                        operationName: operation.operationName,\n                        variables: operation.variables,\n                    },\n                    options: {\n                        withCredentials: withCredentials,\n                        headers: _this.options.headers,\n                    },\n                };\n                if (includeExtensions) {\n                    req.body.extensions = operation.extensions;\n                }\n                if (includeQuery) {\n                    req.body.query = print(operation.query);\n                }\n                if (context.headers) {\n                    req.options.headers = mergeHeaders(req.options.headers, context.headers);\n                }\n                var sub = fetch(req, _this.httpClient).subscribe({\n                    next: function (result) { return observer.next(result.body); },\n                    error: function (err) { return observer.error(err); },\n                    complete: function () { return observer.complete(); },\n                });\n                return function () {\n                    if (!sub.closed) {\n                        sub.unsubscribe();\n                    }\n                };\n            });\n        };\n        return _this;\n    }\n    HttpLinkHandler.prototype.request = function (op) {\n        return this.requester(op);\n    };\n    return HttpLinkHandler;\n}(ApolloLink));\nexport { HttpLinkHandler };\nvar HttpLink = /** @class */ (function () {\n    function HttpLink(httpClient) {\n        this.httpClient = httpClient;\n    }\n    HttpLink.prototype.create = function (options) {\n        return new HttpLinkHandler(this.httpClient, options);\n    };\n    HttpLink.decorators = [\n        { type: Injectable },\n    ];\n    /** @nocollapse */\n    HttpLink.ctorParameters = function () { return [\n        { type: HttpClient, },\n    ]; };\n    return HttpLink;\n}());\nexport { HttpLink };\n//# sourceMappingURL=HttpLink.js.map","import { NgModule } from '@angular/core';\nimport { HttpLink } from './HttpLink';\nexport var PROVIDERS = [HttpLink];\nvar HttpLinkModule = /** @class */ (function () {\n    function HttpLinkModule() {\n    }\n    HttpLinkModule.decorators = [\n        { type: NgModule, args: [{\n                    providers: PROVIDERS,\n                },] },\n    ];\n    /** @nocollapse */\n    HttpLinkModule.ctorParameters = function () { return []; };\n    return HttpLinkModule;\n}());\nexport { HttpLinkModule };\n//# sourceMappingURL=HttpLinkModule.js.map"],"names":["this","LinkObservable","prioritize","print","mergeHeaders","fetch","ApolloLink","Injectable","HttpClient","NgModule"],"mappings":"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"}